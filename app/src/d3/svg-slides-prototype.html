

<!-- https://codepen.io/GreenSock/pen/qBdzqmR -->

<!-- https://css-tricks.com/scale-svg/ -->

<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <base href="./">
    <title>page1 - testx</title>
    <meta property="og:title" content="page1 - testx" />
    <meta name="twitter:title" content="page1 - testx" />
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <!-- Compressed Styles -->
    <style>
      html, body {
        margin: 0;
        height: 100%;
        -webkit-overflow-scrolling: touch;
        overflow-scrolling: touch;
        font-family: "Signika Negative", sans-serif, Arial;
      }
     

    </style>
   
     
</head>

<body class="slides scroll animated noPreload">


  <div id="container">

    <!-- <svg width="100%" height="100%" viewBox="0 0 1440 900" transform="scale (0.90) translate (0 0)"> -->
      <svg width="100%" height="100%" viewBox="0 0 1411 3454" transform="scale (1.0) translate (0 0)">
          <g id="ArtBoard1" transform="matrix(0.979861,0,0,0.803333,0,0)">
              <rect x="0" y="0" width="1440" height="900" style="fill:none;"/>
              <clipPath id="_clip1">
                  <rect x="0" y="0" width="1440" height="900"/>
              </clipPath>
              <g clip-path="url(#_clip1)">
                  <g id="bg1" transform="matrix(3.45333,0,0,3.00229,-931.46,-566.294)">
                      <rect x="269.728" y="188.621" width="416.988" height="299.771" style="fill:rgb(245,105,38);"/>
                  </g>
                  <g transform="matrix(1.02055,0,0,1.24481,-348.542,-138.006)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(235,235,235);"/>
                  </g>
                  <g transform="matrix(0.085765,0,0,0.147302,-31.0875,-27.7825)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(255,52,0);"/>
                  </g>
                  <g transform="matrix(0.085765,0,0,0.147302,1373.79,-27.7825)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(255,52,0);"/>
                  </g>
                  <g transform="matrix(0.085765,0,0,0.147302,1373.79,829.473)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(255,52,0);"/>
                  </g>
                  <g transform="matrix(0.085765,0,0,0.147302,-31.0875,829.473)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(255,52,0);"/>
                  </g>
                  <g transform="matrix(1.02055,0,0,1.24481,-348.542,-138.006)">
                      <rect x="846.195" y="469.494" width="236.318" height="183.046" style="fill:rgb(235,235,235);"/>
                  </g>
                  <g transform="matrix(1.02055,0,0,1.24481,-503.113,-104.334)">
                      <text x="818.397px" y="327.771px" style="font-family:'ArialMT', 'Arial', sans-serif;font-size:48px;">Ebene 1</text>
                  </g>
              </g>
          </g>
          <g id="ArtBoard2" transform="matrix(0.979861,0,0,0.803333,0,723)">
              <rect x="0" y="0" width="1440" height="900" style="fill:none;"/>
              <clipPath id="_clip2">
                  <rect x="0" y="0" width="1440" height="900"/>
              </clipPath>
              <g clip-path="url(#_clip2)">
                  <g id="bg2" transform="matrix(3.45333,0,0,3.00229,-931.46,-566.294)">
                      <rect x="269.728" y="188.621" width="416.988" height="299.771" style="fill:rgb(23,27,124);"/>
                  </g>
                  <g transform="matrix(1.02055,0,0,1.24481,133.021,-94.5763)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(235,235,235);"/>
                  </g>
                  <g transform="matrix(0.085765,0,0,0.147302,-31.0875,-27.7825)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(255,52,0);"/>
                  </g>
                  <g transform="matrix(0.085765,0,0,0.147302,1373.79,-27.7825)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(255,52,0);"/>
                  </g>
                  <g transform="matrix(0.085765,0,0,0.147302,1373.79,829.473)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(255,52,0);"/>
                  </g>
                  <g transform="matrix(0.085765,0,0,0.147302,-31.0875,829.473)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(255,52,0);"/>
                  </g>
                  <g transform="matrix(1.02055,0,0,1.24481,133.021,-94.5763)">
                      <rect x="846.195" y="469.494" width="236.318" height="183.046" style="fill:rgb(235,235,235);"/>
                  </g>
                  <g transform="matrix(1.02055,0,0,1.24481,-21.5498,-60.9036)">
                      <text x="818.397px" y="327.771px" style="font-family:'ArialMT', 'Arial', sans-serif;font-size:48px;">Ebene 2</text>
                  </g>
              </g>
          </g>
          <g id="ArtBoard3" transform="matrix(0.979861,0,0,1.42744,0,1446)">
              <rect x="0" y="0" width="1440" height="900" style="fill:none;"/>
              <clipPath id="_clip3">
                  <rect x="0" y="0" width="1440" height="900"/>
              </clipPath>
              <g clip-path="url(#_clip3)">
                  <g id="bg3" transform="matrix(3.45333,0,0,3.00229,-931.46,-566.294)">
                      <rect x="269.728" y="188.621" width="416.988" height="299.771" style="fill:rgb(83,19,81);"/>
                  </g>
                  <g transform="matrix(1.02055,0,0,0.700553,-190.902,-7.13878)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(235,235,235);"/>
                  </g>
                  <g transform="matrix(0.085765,0,0,0.0828981,-31.0875,-15.6354)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(255,52,0);"/>
                  </g>
                  <g transform="matrix(0.085765,0,0,0.0828981,1373.79,-16.3359)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(255,52,0);"/>
                  </g>
                  <g transform="matrix(0.085765,0,0,0.0828981,1373.79,860.309)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(255,52,0);"/>
                  </g>
                  <g transform="matrix(0.085765,0,0,0.0828981,-31.0875,860.309)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(255,52,0);"/>
                  </g>
                  <g transform="matrix(1.02055,0,0,0.700553,-190.902,-7.13878)">
                      <rect x="846.195" y="469.494" width="236.318" height="183.046" style="fill:rgb(235,235,235);"/>
                  </g>
                  <g transform="matrix(1.02055,0,0,0.700553,-345.473,11.8115)">
                      <text x="818.397px" y="327.771px" style="font-family:'ArialMT', 'Arial', sans-serif;font-size:48px;">Ebene 3 (gro√ü)</text>
                  </g>
              </g>
          </g>

          <g id="ArtBoard4" transform="matrix(0.979861,0,0,0.803333,0,2730.7)">
              <rect x="0" y="0" width="1440" height="900" style="fill:none;"/>
              <clipPath id="_clip4">
                  <rect x="0" y="0" width="1440" height="900"/>
              </clipPath>
              <g clip-path="url(#_clip4)">
                  <g id="bg4" transform="matrix(3.45333,0,0,3.00229,-931.46,-566.294)">
                      <rect x="269.728" y="188.621" width="416.988" height="299.771" style="fill:rgb(230,204,23);"/>
                  </g>
                  <g transform="matrix(1.02055,0,0,1.24481,133.021,-94.5763)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(235,235,235);"/>
                  </g>
                  <g transform="matrix(0.085765,0,0,0.147302,-31.0875,-27.7825)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(255,52,0);"/>
                  </g>
                  <g transform="matrix(0.085765,0,0,0.147302,1373.79,-27.7825)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(255,52,0);"/>
                  </g>
                  <g transform="matrix(0.085765,0,0,0.147302,1373.79,829.473)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(255,52,0);"/>
                  </g>
                  <g transform="matrix(0.085765,0,0,0.147302,-31.0875,829.473)">
                      <rect x="410.07" y="222.413" width="314.31" height="222.576" style="fill:rgb(255,52,0);"/>
                  </g>
                  <g transform="matrix(1.02055,0,0,1.24481,133.021,-94.5763)">
                      <rect x="846.195" y="469.494" width="236.318" height="183.046" style="fill:rgb(235,235,235);"/>
                  </g>
                  <g transform="matrix(1.02055,0,0,1.24481,-21.5498,-60.9036)">
                      <text x="818.397px" y="327.771px" style="font-family:'ArialMT', 'Arial', sans-serif;font-size:48px;">Ebene 4</text>
                  </g>
              </g>
          </g>
      </svg>
    


  </div>



<script src="d3vendor/d3.v3.min.js"></script>

<script src="d3vendor/gsap3-4-2.min.js" type="text/javascript"></script>
<script src="d3vendor/ScrollTrigger3-4-2.min.js" type="text/javascript"></script>
<script src="d3vendor/zdog.dist.1.1.2.js" type="text/javascript"></script>

<script>

    gsap.registerPlugin(ScrollTrigger);

    var browser = d3.select('body');
    var svg = d3.select("#container svg")
    var browserWidth = parseInt(browser.style("width"),10);
    var browserHeight = parseInt(browser.style("height"),10);
    console.log(browserWidth + " " + browserHeight);

    
    svg.attr("width", browserWidth)
      .attr("height", browserHeight)
      .attr("viewBox", "0 0 " + browserWidth + " " + browserHeight)
      .attr("perserveAspectRatio", "xMidYMid")
  
    d3.select("#ArtBoard2")
      //.attr("transform=", "matrix(0.979861,0,0,0.803333,0,723)")
      .attr("transform", "matrix(0.979861,0,0,0.803333,0,0)")

    d3.select("#ArtBoard3")
      //.attr("transform=", "matrix(0.979861,0,0,1.42744,0,1446)")
      .attr("transform", "matrix(0.979861,0,0,1.42744,0,0)")

    d3.select("#ArtBoard4")
      //.attr("transform=", "matrix(0.979861,0,0,0.803333,0,2730.7)")
      .attr("transform", "matrix(0.979861,0,0,0.803333,0,0)")


    gsap.defaults({ease: "none", duration: 2});  

    const tl = gsap.timeline();
    tl.addLabel("Slide2")
      .from("#ArtBoard2", {xPercent: -100})
      .addLabel("Slide3")
      .from("#ArtBoard3", {yPercent: 200})
      .addLabel("Slide4") 
      .to("#ArtBoard3", {yPercent: -62.5})
      .from("#ArtBoard4", {xPercent: 100});
  

    function closest(needle, haystack) {
      return haystack.reduce(function (a, b) {
        var aDiff = Math.abs(a.percent - needle);
        var bDiff = Math.abs(b.percent - needle);

        if (aDiff == bDiff) {
          return {percent: a.percent > b.percent ? a.percent : b.percent};
        } else {
          return {percent: bDiff < aDiff ? b.percent : a.percent};
        }
      });
    }

    var scrollStatus;

    var slideConfig = [
      {index: 0, time: 0, percent: 0},
      {index: 1, time: 2, percent: 0.25},
      {index: 2, time: 4, percent: 0.5},
      {index: 3, time: 6, percent: 1}
    ]

    ScrollTrigger.create({
      animation: tl,
      trigger: "#container",
      start: "top top",
      markers: true,
      end: "+=2000", 
      scrub: 0.5,
      snap: {
        snapTo: function(value) { 
          if ((value > 0.5) && (value < 0.7)) {
            target = value;
          }
          else {
            target = closest(value, slideConfig).percent;
          }
          return target
        },
        delay: 0,
        duration: 0.2
      },
      onUpdate: self => {
        /*
        console.log(
          "progress:", self.progress.toFixed(3), 
          "direction:", self.direction, 
          "velocity", self.getVelocity()
          );
        */  
        scrollStatus = self;
      },
      pin: true,
      anticipatePin: 1
    });

   

    window.addEventListener('keydown', function(e) {
      if(e.keyCode == 32 && e.target == document.body) {
        e.preventDefault();
        //console.log('SPACE ' + scrollStatus.progress);
        
        //tl.tweenTo(2, {ease: "strong", duration: 1.0}) // seconds!
        tl.tweenTo(tl.nextLabel(), {ease: "strong", duration: 0.5})
      }
    });
    

    
    /*
    ScrollTrigger.create({
      trigger: "#container",
      start: "top top",
      markers: true,
      //snap: [0.2, 0.5, 1]
      //pin: true, 
      //pinSpacing: false 
    });
    */

    

    
</script>
     
</body>
</html>